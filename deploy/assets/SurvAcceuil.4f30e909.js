import{_ as j,r as u,aI as H,c as L,k as W,l as f,J as p,f as n,n as r,a4 as D,Q as G,a8 as Q,aS as I,K as a,F as C,al as N,aq as i,ak as x,aT as K,m as X,ao as Y,aU as Z,M as $,N as ee}from"./index.f98bd38e.js";import{a as B,Q as O,b as _}from"./QDialog.73c50ee4.js";import{Q as V}from"./QSeparator.1652b76b.js";import{u as ae}from"./use-quasar.faf7bcac.js";import{k as oe}from"./vue-qrcode-reader.1a128e60.js";import{u as te}from"./surveillance.e2d7cbc2.js";import"./use-dark.c38352e8.js";import"./use-timeout.1a21eaf5.js";import"./focus-manager.05708ea9.js";import"./axios.6e1fcf85.js";const le={components:{QrcodeStream:oe},setup(){const v=u(""),s=u(!1);ae();const w=u(!1),e=te(),g=u(null),F=u(null);function T(l){l.forEach(t=>{g.value={id_enseignement:JSON.parse(t.rawValue).id_enseignement,id_etudiant:JSON.parse(t.rawValue).id_etudiant},e.GetSurvEt(g.value).then(m=>{s.value=!1,w.value=!0,F.value=m,console.log(m)}),console.log(g.value)}),v.value=JSON.stringify(l.map(t=>t.rawValue))}const o=u(null),b=u([]);H(async()=>{await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),b.value=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:l})=>l==="videoinput"),b.value.length>0&&(o.value=b.value[0])});function P(l,t){for(const m of l){const[c,...k]=m.cornerPoints;t.strokeStyle="red",t.beginPath(),t.moveTo(c.x,c.y);for(const{x:h,y:S}of k)t.lineTo(h,S);t.lineTo(c.x,c.y),t.closePath(),t.stroke()}}function U(l,t){for(const m of l){const{boundingBox:{x:c,y:k,width:h,height:S}}=m;t.lineWidth=2,t.strokeStyle="#007bff",t.strokeRect(c,k,h,S)}}function A(l,t){for(const m of l){const{boundingBox:c,rawValue:k}=m,h=c.x+c.width/2,S=c.y+c.height/2,R=Math.max(12,50*c.width/t.canvas.width);t.font=`bold ${R}px sans-serif`,t.textAlign="center",t.lineWidth=3,t.strokeStyle="#35495e",t.strokeText(m.rawValue,h,S),t.fillStyle="#5cb984",t.fillText(k,h,S)}}const q=[{text:"nothing (default)",value:void 0},{text:"outline",value:P},{text:"centered text",value:A},{text:"bounding box",value:U}],M=u(q[1]),E=u({aztec:!1,code_128:!1,code_39:!1,code_93:!1,codabar:!1,databar:!1,databar_expanded:!1,data_matrix:!1,dx_film_edge:!1,ean_13:!1,ean_8:!1,itf:!1,maxi_code:!1,micro_qr_code:!1,pdf417:!1,qr_code:!0,rm_qr_code:!1,upc_a:!1,upc_e:!1,linear_codes:!1,matrix_codes:!1}),z=L(()=>Object.keys(E.value).filter(l=>E.value[l])),d=u("");function J(l){d.value=`[${l.name}]: `,l.name==="NotAllowedError"?d.value+="you need to grant camera access permission":l.name==="NotFoundError"?d.value+="no camera on this device":l.name==="NotSupportedError"?d.value+="secure context required (HTTPS, localhost)":l.name==="NotReadableError"?d.value+="is the camera already in use?":l.name==="OverconstrainedError"?d.value+="installed cameras are not suitable":l.name==="StreamApiNotSupportedError"?d.value+="Stream API is not supported in this browser":l.name==="InsecureContextError"?d.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":d.value+=l.message}return{open:s,stat:w,resultD:F,onDetect:T,selectedDevice:o,devices:b,trackFunctionSelected:M,selectedBarcodeFormats:z,onError:J,trackFunctionOptions:q,error:d,barcodeFormats:E}}},y=v=>($("data-v-322dee50"),v=v(),ee(),v),ne={class:"main"},se=y(()=>a("span",{class:"q-ml-sm"},[a("b",null,"Scanner le code QR de l'examen")],-1)),re=["value"],ce=y(()=>a("br",null,null,-1)),ie=["onUpdate:modelValue","id"],de=["for"],ue={class:"error"},me={class:"decode-result"},fe=y(()=>a("div",null,"Selectionner un camera",-1)),_e=["value"],ve=y(()=>a("div",{class:"flex flex-center"}," D\xE9termination d'acc\xE8s \xE0 la salle d'examen ",-1)),pe={class:"row"},be={class:"col"},he={class:"q-ml-sm"},Se={class:"col",caption:""},ye={class:"q-ml-sm"},ke={class:"q-ml-sm"},xe=y(()=>a("br",null,null,-1)),ge=y(()=>a("br",null,null,-1));function De(v,s,w,e,g,F){const T=W("QrcodeStream");return f(),p("div",ne,[n(B,{class:"absolute-center"},{default:r(()=>[n(_,{class:"flex flex-center"},{default:r(()=>[n(D,{name:"qr_code",color:"primary",size:"200%"}),se]),_:1}),n(_,{class:"section"},{default:r(()=>[n(G,{label:"Scanner",align:"right",color:"primary",icon:"edit",onClick:s[0]||(s[0]=o=>e.open=!e.open)})]),_:1})]),_:1}),n(O,{modelValue:e.open,"onUpdate:modelValue":s[3]||(s[3]=o=>e.open=o)},{default:r(()=>[n(B,{class:"my-card"},{default:r(()=>[n(_,null,{default:r(()=>[Q(a("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.trackFunctionSelected=o)},[(f(!0),p(C,null,N(e.trackFunctionOptions,o=>(f(),p("option",{key:o.text,value:o},i(o.text),9,re))),128))],512),[[I,e.trackFunctionSelected]])]),_:1}),n(_,null,{default:r(()=>[a("p",null,[x(" Choisis un format : "),ce,(f(!0),p(C,null,N(Object.keys(e.barcodeFormats),o=>(f(),p("span",{key:o,class:"barcode-format-checkbox"},[Q(a("input",{type:"checkbox","onUpdate:modelValue":b=>e.barcodeFormats[o]=b,id:o},null,8,ie),[[K,e.barcodeFormats[o]]]),a("label",{for:o},i(o),9,de)]))),128))]),a("p",ue,i(e.error),1),a("p",me,[x(" Last result: "),a("b",null,i(v.result),1)])]),_:1}),n(_,null,{default:r(()=>[e.selectedDevice!==null?(f(),X(T,{key:0,constraints:{deviceId:e.selectedDevice.deviceId},track:e.trackFunctionSelected.value,formats:e.selectedBarcodeFormats,onError:e.onError,onDetect:e.onDetect},null,8,["constraints","track","formats","onError","onDetect"])):Y("",!0)]),_:1}),n(_,null,{default:r(()=>[fe,Q(a("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>e.selectedDevice=o)},[(f(!0),p(C,null,N(e.devices,o=>(f(),p("option",{key:o.label,value:o},i(o.label),9,_e))),128))],512),[[I,e.selectedDevice]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(O,{modelValue:e.stat,"onUpdate:modelValue":s[4]||(s[4]=o=>e.stat=o)},{default:r(()=>[n(B,null,{default:r(()=>[n(_,null,{default:r(()=>[ve,n(V)]),_:1}),n(_,null,{default:r(()=>[a("div",pe,[a("div",be,[n(D,{name:"auto_stories",color:"primary"}),a("span",he,[a("b",null,i(e.resultD.response.nom_cours),1)])]),n(V,{vertical:""}),a("div",Se,[a("div",null,[n(D,{name:"event",color:"primary"}),a("span",ye,[a("b",null,i(e.resultD.response.date_exam),1)])]),a("div",null,[n(D,{name:"alarm",color:"primary"}),a("span",ke,[a("b",null,i(e.resultD.response.heure_exam),1)])])])]),n(V),a("div",null,[a("p",null,[x(" Total nombre pr\xE9sences : "+i(e.resultD.total.nombre)+" ",1),xe,x(" Vos pr\xE9sences : "+i(e.resultD.presence.nombre_presence),1)]),n(V),x(" Resultat : "+i("Vous avez particip\xE9 \xE0 "+e.resultD.presence.nombre_presence/e.resultD.total.nombre*100+"% du cours")+" ",1),ge,a("div",{style:Z(parseFloat(e.resultD.presence.nombre_presence/e.resultD.total.nombre*100)<75?{color:"red"}:{color:"green"})},i(parseFloat(e.resultD.presence.nombre_presence/e.resultD.total.nombre*100)>75?"Acc\xE8s autorise":"Acc\xE8s refus\xE9"),5)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Ie=j(le,[["render",De],["__scopeId","data-v-322dee50"]]);export{Ie as default};
