import{_ as M,r as m,aI as A,c as j,k as z,l as u,J as _,f as l,n as d,a4 as H,Q as J,a8 as C,aS as E,K as r,F as D,al as F,aq as k,ak as B,aT as R,m as L,ao as W,M as K,N as X}from"./index.f98bd38e.js";import{a as I,Q as Y,b}from"./QDialog.73c50ee4.js";import"./cours.171cf30b.js";import{u as G}from"./use-quasar.faf7bcac.js";import{k as Z}from"./vue-qrcode-reader.1a128e60.js";import{u as $}from"./postcss.77e54e42.js";import"./use-dark.c38352e8.js";import"./use-timeout.1a21eaf5.js";import"./focus-manager.05708ea9.js";import"./axios.6e1fcf85.js";import"./_commonjsHelpers.0592d25c.js";const ee={components:{QrcodeStream:Z},setup(){const f=m(""),s=m(!1),S=G(),t=$();function V(a){a.forEach(e=>{let i={id_enseignement:JSON.parse(e.rawValue).id,id_etudiant:localStorage.getItem("userId")};console.log(i),t.savePresence(i).then(n=>{n.positive?(S.notify({message:"Presence sign\xE9e",icon:"check",iconColor:"white",textColor:"white",color:"green"}),s.value=!1):S.notify({message:"Presence sign\xE9e",icon:"error",iconColor:"white",textColor:"white",color:"red"})})}),f.value=JSON.stringify(a.map(e=>e.rawValue))}const y=m(null),v=m([]);A(async()=>{await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),v.value=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:a})=>a==="videoinput"),v.value.length>0&&(y.value=v.value[0])});function o(a,e){for(const i of a){const[n,...g]=i.cornerPoints;e.strokeStyle="red",e.beginPath(),e.moveTo(n.x,n.y);for(const{x:p,y:h}of g)e.lineTo(p,h);e.lineTo(n.x,n.y),e.closePath(),e.stroke()}}function x(a,e){for(const i of a){const{boundingBox:{x:n,y:g,width:p,height:h}}=i;e.lineWidth=2,e.strokeStyle="#007bff",e.strokeRect(n,g,p,h)}}function N(a,e){for(const i of a){const{boundingBox:n,rawValue:g}=i,p=n.x+n.width/2,h=n.y+n.height/2,U=Math.max(12,50*n.width/e.canvas.width);e.font=`bold ${U}px sans-serif`,e.textAlign="center",e.lineWidth=3,e.strokeStyle="#35495e",e.strokeText(i.rawValue,p,h),e.fillStyle="#5cb984",e.fillText(g,p,h)}}const T=[{text:"nothing (default)",value:void 0},{text:"outline",value:o},{text:"centered text",value:N},{text:"bounding box",value:x}],Q=m(T[1]),w=m({aztec:!1,code_128:!1,code_39:!1,code_93:!1,codabar:!1,databar:!1,databar_expanded:!1,data_matrix:!1,dx_film_edge:!1,ean_13:!1,ean_8:!1,itf:!1,maxi_code:!1,micro_qr_code:!1,pdf417:!1,qr_code:!0,rm_qr_code:!1,upc_a:!1,upc_e:!1,linear_codes:!1,matrix_codes:!1}),O=j(()=>Object.keys(w.value).filter(a=>w.value[a])),c=m("");function q(a){c.value=`[${a.name}]: `,a.name==="NotAllowedError"?c.value+="you need to grant camera access permission":a.name==="NotFoundError"?c.value+="no camera on this device":a.name==="NotSupportedError"?c.value+="secure context required (HTTPS, localhost)":a.name==="NotReadableError"?c.value+="is the camera already in use?":a.name==="OverconstrainedError"?c.value+="installed cameras are not suitable":a.name==="StreamApiNotSupportedError"?c.value+="Stream API is not supported in this browser":a.name==="InsecureContextError"?c.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":c.value+=a.message}return{open:s,onDetect:V,selectedDevice:y,devices:v,trackFunctionSelected:Q,selectedBarcodeFormats:O,onError:q,trackFunctionOptions:T,error:c,barcodeFormats:w}}},P=f=>(K("data-v-ca42a098"),f=f(),X(),f),oe={class:"main"},te=P(()=>r("span",{class:"q-ml-sm"},[r("b",null,"Scanner le code QR de la presence")],-1)),ae=["value"],ne=P(()=>r("br",null,null,-1)),re=["onUpdate:modelValue","id"],se=["for"],le={class:"error"},ce={class:"decode-result"},ie=P(()=>r("div",null,"Selectionner un camera",-1)),de=["value"];function ue(f,s,S,t,V,y){const v=z("QrcodeStream");return u(),_("div",oe,[l(I,{class:"absolute-center"},{default:d(()=>[l(b,{class:"flex flex-center"},{default:d(()=>[l(H,{name:"auto_stories",color:"primary",size:"200%"}),te]),_:1}),l(b,{class:"section"},{default:d(()=>[l(J,{label:"Scanner",align:"right",color:"primary",icon:"edit",onClick:s[0]||(s[0]=o=>t.open=!t.open)})]),_:1})]),_:1}),l(Y,{modelValue:t.open,"onUpdate:modelValue":s[3]||(s[3]=o=>t.open=o)},{default:d(()=>[l(I,{class:"my-card"},{default:d(()=>[l(b,null,{default:d(()=>[C(r("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.trackFunctionSelected=o)},[(u(!0),_(D,null,F(t.trackFunctionOptions,o=>(u(),_("option",{key:o.text,value:o},k(o.text),9,ae))),128))],512),[[E,t.trackFunctionSelected]])]),_:1}),l(b,null,{default:d(()=>[r("p",null,[B(" Choisis un format : "),ne,(u(!0),_(D,null,F(Object.keys(t.barcodeFormats),o=>(u(),_("span",{key:o,class:"barcode-format-checkbox"},[C(r("input",{type:"checkbox","onUpdate:modelValue":x=>t.barcodeFormats[o]=x,id:o},null,8,re),[[R,t.barcodeFormats[o]]]),r("label",{for:o},k(o),9,se)]))),128))]),r("p",le,k(t.error),1),r("p",ce,[B(" Last result: "),r("b",null,k(f.result),1)])]),_:1}),l(b,null,{default:d(()=>[t.selectedDevice!==null?(u(),L(v,{key:0,constraints:{deviceId:t.selectedDevice.deviceId},track:t.trackFunctionSelected.value,formats:t.selectedBarcodeFormats,onError:t.onError,onDetect:t.onDetect},null,8,["constraints","track","formats","onError","onDetect"])):W("",!0)]),_:1}),l(b,null,{default:d(()=>[ie,C(r("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.selectedDevice=o)},[(u(!0),_(D,null,F(t.devices,o=>(u(),_("option",{key:o.label,value:o},k(o.label),9,de))),128))],512),[[E,t.selectedDevice]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var xe=M(ee,[["render",ue],["__scopeId","data-v-ca42a098"]]);export{xe as default};
